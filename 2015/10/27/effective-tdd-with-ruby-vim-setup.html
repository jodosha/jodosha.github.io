<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Effective TDD With Ruby: Vim Setup &mdash; Luca Guidi</title>
<link href="http://fonts.googleapis.com/css?family=Lato:400,900" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="/assets/main.css">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="/images/logo.png"/>
<link href="http://feeds.feedburner.com/LucaGuidi" rel="alternate" title="Luca Guidi" type="application/atom+xml" />
<meta name="title" content="Effective TDD With Ruby: Vim Setup ">
<link rel="canonical" href="http://lucaguidi.com/2015/10/27/effective-tdd-with-ruby-vim-setup.html">


<meta property="og:title" content="Effective TDD With Ruby: Vim Setup "/>
<meta property="og:url" content="http://lucaguidi.com/2015/10/27/effective-tdd-with-ruby-vim-setup.html"/>

<meta property="og:image" content="http://lucaguidi.com/images/effective-tdd-with-ruby-vim-setup.jpg"/>

<meta property="og:image" content="http://lucaguidi.com/images/logo.png"/>   


<meta property="og:description" content="Do you find TDD good in theory but hard to practice? Do you think it requires too much discipline and you don’t have time? You can improve a lot, by borrowing well tested tricks from me. They are simple, effective and easy to learn.
"/>
<meta name="description" content="Do you find TDD good in theory but hard to practice? Do you think it requires too much discipline and you don’t have time? You can improve a lot, by borrowing well tested tricks from me. They are simple, effective and easy to learn.
"/>

<meta property="og:site_name" content="Luca Guidi">
<meta name="twitter:card"        content="summary_large_image">
<meta name="twitter:site"        content="@jodosha">
<meta name="twitter:creator"     content="@jodosha">
<meta name="twitter:url"         content="http://lucaguidi.com/2015/10/27/effective-tdd-with-ruby-vim-setup.html">
<meta name="twitter:title"       content="Effective TDD With Ruby: Vim Setup "/>

<meta name="twitter:description" content="Do you find TDD good in theory but hard to practice? Do you think it requires too much discipline and you don’t have time? You can improve a lot, by borrowing well tested tricks from me. They are simple, effective and easy to learn.
">


<meta property="twitter:image:src" content="http://lucaguidi.com/images/effective-tdd-with-ruby-vim-setup.jpg"/>

<meta property="twitter:image:src" content="http://lucaguidi.com/images/logo.png"/>

<meta name="description" content="Luca Guidi website">
<meta name="keywords" content="luca,guidi,luca guidi,programmer,developer,rome,italy,ruby,javascript,go,golang,redis,oop,tdd,bdd,unix,open source">
<meta name="author" content="Luca Guidi">
</head>
<body>

<section class="site-nav">
  <header>
    <nav id="navigation">
      <a class="brand" href="/">
        <img src="/images/logo.png" alt="Inc">
      </a>
      <a href="/" class="home">Blog</a>
      
      <a href="/about.html">About</a>
      <a href="/archive.html" class="home">Archive</a>
      <a href="https://github.com/jodosha" class="code" target="_blank">Code</a>
      <a href="http://theplayli.st" class="code" target="_blank">Music</a>
    </nav>
    
  </header>
</section>


<div class="article-cover">
    <div>
        <img src="/images/effective-tdd-with-ruby-vim-setup.jpg" class="image">
    </div>
</div>

<article>

    <div class="container">
        <header>
            <div class="meta">
                By <address><a rel="author" href="" title="Luca Guidi" target="_blank">Luca Guidi</a> &mdash;
                <time pubdate datetime="2015-27-October" title="October 27, 2015">October 27, 2015</time>
            </div>
            <h1 class="title">Effective TDD With Ruby: Vim Setup</h1>
            
        </header>

        <section>
            <p>Do you find <a href="https://en.wikipedia.org/wiki/Test-driven_development">Test Driven Development</a> (TDD) good in theory but hard to practice? Do you think it requires too much discipline and you don’t have time? Or, are you just struggling to get your workflow streamlined? Fighting to glue your tools together?</p>

<p>Well, you can improve a <strong>lot</strong>, by borrowing some tricks from me. I’ve practiced TDD with Ruby for many years now, and built an entire <a href="http://lotusrb.org">web framework</a> only with these techniques.</p>

<p>They are simple, effective and easy to learn.</p>

<p>Last time we talked about <a href="/2015/10/20/effective-tdd-with-ruby-time-and-flow.html">time management</a>. Today we’ll focus on <strong>Vim setup</strong> and how this is important to follow the <a href="/2015/10/20/effective-tdd-with-ruby-time-and-flow.html"><em>“not break the flow”</em></a> rule.</p>

<h2 id="env-vars">Env Vars</h2>

<p>Use <code>export EDITOR=vim</code> in your shell startup file (e.g. <code>.zshrc</code>). This is a convention that’s followed by a lot of softwares like <a href="http://bundler.io">Bundler</a>.</p>

<h2 id="vim-vs-macvim">Vim vs MacVim</h2>

<p>I prefer to use Vim over MacVim because the shell is always a <code>Ctrl+z</code> away from the editor.</p>

<p>That shortcut works on all the UNIX systems, it sends a <a href="https://en.wikipedia.org/wiki/Job_control_(Unix)#Implementation"><code>SIGTSTP</code></a> signal to the current process and puts it in background. You can resume it with <code>fg</code>.</p>

<p><img src="/images/vim-ctrl-z-fg.gif" alt="" /></p>

<p>I often use it for Git commands or to open another gem source code via <code>bundle open foo</code>. This will starts another Vim process in the same shell. To switch between all instances of the editor, you can use <code>Ctrl+z</code> to put the current on sleep and then <code>%1</code> or <code>%2</code> or <code>%3</code>, etc… That number corresponds to the opening order of your processes.</p>

<p>For instance, if you have started <code>vim .</code> first, that will be resumable with <code>%1</code>. Then you have opened <code>foo</code> gem, that will match to <code>%2</code>.</p>

<h2 id="build-your-own-setup">Build Your Own Setup</h2>

<p>Let’s admit it, vanilla Vim, isn’t that useful. When I re-learned it years ago, I decided to use <a href="https://github.com/carlhuda/janus">Janus</a> as a standard setup. It’s a good starting point, but then you realise that you just use 20%/30% of what’s provided there.</p>

<p>My suggestion is to start from scratch and <strong>build your own setup</strong>. Then slowly add plugins when you need a feature in your day by day development.</p>

<p>It’s <strong>funny</strong> and you’ll learn a lot about Vim.</p>

<p>For inspiration, have a look at <a href="https://github.com/tpope/tpope/blob/master/.vimrc">Tim Pope</a>, <a href="https://github.com/mislav/vimfiles/blob/master/vimrc">Mislav Marohnić</a>, <a href="https://github.com/garybernhardt/dotfiles/blob/master/.vimrc">Gary Bernhardt</a>, <a href="https://github.com/paulirish/dotfiles/blob/master/.vimrc">Paul Irish</a>, <a href="https://github.com/nelstrom/dotfiles/blob/master/vimrc">Drew Neil</a>, <a href="https://github.com/thoughtbot/dotfiles/blob/master/vimrc">Thoughtbot</a>, <a href="https://bitbucket.org/sjl/dotfiles/src/1da770d23a2168f0e0c2e50d0d3e84e5c6d38d27/vim/vimrc?at=default&amp;fileviewer=file-view-default">Steve Losh</a> and <a href="https://github.com/jodosha/dotfiles/blob/master/.vimrc">my</a> <code>.vimrc</code> configuration. As future reference, remember to document each setting. By reading the examples above, if you run into something unknown like <code>expandtab</code>, just use Vim <code>:help expandtab</code> and you’ll get a detailed explanation.</p>

<h2 id="plugins">Plugins</h2>

<p>With the minimalist approach described above, start to add only the plugins that you need. I strongly suggest to use a plugin manager such as <a href="https://github.com/tpope/vim-pathogen">Pathogen</a> or <a href="https://github.com/VundleVim/Vundle.vim">Vundle</a>. As of today, plugin authors assume that one of these two systems are present in your Vim setup.</p>

<p>Let’s examine some useful stuff to enhance your Vim experience.</p>

<h3 id="theme">Theme</h3>

<p>The visual aspect of our beloved editor is important to prevent <a href="http://www.allaboutvision.com/cvs/irritated.htm">eye strain</a>. The rule is to set the background color to match the luminosity of the room. In general, a dark theme makes screen easier to look at for long period of times. Consider big and bold fonts, high contrast. If your eyes are irritated, don’t hesitate to see your doctor.</p>

<p>There are several themes for Vim. If you don’t know which one to choose, here’s what to do:</p>

<ol>
  <li>Install <a href="https://github.com/flazz/vim-colorschemes">vim-colorschemes</a>.</li>
  <li>Borrow <a href="https://github.com/jodosha/dotfiles/blob/master/.vimrc#L143-L157">this function</a> from my <code>.vimrc</code></li>
  <li>Type <code>&lt;leader&gt;tc</code> and watch your Vim to change theme each four seconds. Once you’ll see the one that you like, type <code>Ctrl+c</code>.</li>
</ol>

<p><img src="/images/vim-carousel.gif" alt="" /></p>

<h3 id="vim-ruby">Vim-Ruby</h3>

<p>This <a href="https://github.com/vim-ruby/vim-ruby">plugin</a> offers everything you are looking for Ruby dev with Vim. It supports syntax highlighting, syntax errors, unused variables, auto-closing <code>do/end</code>, code auto-indentation, auto-complete facilities, etc…</p>

<h3 id="find-in-project">Find In Project</h3>

<p>One can easily get lost with large codebases. A fast and reliable search tool is crucial to stay focused. I use <a href="https://github.com/ggreer/the_silver_searcher">The Silver Searcher</a> as Vim backend.</p>

<p>I mapped <code>&lt;leader&gt;,</code> to search in project or <code>shift+k</code> to find the word under the cursor. Both open a “Quickfix List” pane with a set of results, each of them can take you to the correspoding file, by hitting <code>enter</code> on the line. Here’s the relevant <code>.vimrc</code> <a href="https://github.com/jodosha/dotfiles/blob/master/.vimrc#L165-L182">configuration</a>.</p>

<h3 id="quick-file-open">Quick File Open</h3>

<p>The Silver Searcher can be used as a backend for <a href="https://github.com/kien/ctrlp.vim">ctrlp</a>, a plugin that let’s you to quickly open a file by name. For instance <code>Ctrl+p</code> and start to type. It filters instantly the results. Use arrows to navigate results and <code>enter</code> to open the file or <code>Ctrl+v</code> for a vertical split pane.</p>

<h3 id="code-navigation">Code Navigation</h3>

<p>Unfortunately these two techniques return results only from your application codebase. Sometimes it’s useful to have a quick look at the source code of a dependency.</p>

<p>For instance, your cursor is on <code>Foo</code> constant and you want open the corresponding gem to place a debugger. </p>

<p>For this purpose install <a href="http://ctags.sourceforge.net/">Exuberant Ctags</a> and run <a href="https://github.com/jodosha/dotfiles/blob/master/bin/retag">this script</a>. The output is a file named <code>tags</code> which contains the class/module/methods references for Ruby core, standard library, your application and for <strong>all the gems that you use</strong>. Don’t forget to add it to <code>.gitignore</code>. I <a href="https://github.com/jodosha/dotfiles/blob/master/.vimrc#L75">mapped</a> it to <code>&lt;leader&gt;rt</code>.</p>

<p>Once done, when the cursor is on <code>Foo</code>, just use <code>Ctrl+]</code> and Vim will open the file where <code>Foo</code> is defined. Then use <code>Ctrl+[</code> to get back.</p>

<p>If <code>Foo</code> isn’t under your cursor, use <code>:tag Foo</code>. If the result isn’t what you expected (try with <code>String</code>;), use <code>:ts Foo</code> for a list of all the matches.</p>

<h3 id="autocomplete">Autocomplete</h3>

<p>There are a couple of options for code autocomplete. The first is <a href="http://vim.wikia.com/wiki/Any_word_completion">“Any word completion”</a>. It suggests all the words found in the project. It’s activated via <code>Ctrl+n</code> and it’s useful for recurring tokens.</p>

<p>If you want to leverage the tags that we’ve just created, install <a href="https://github.com/ervandew/supertab">Supertab</a>. When in insert mode, you can type <code>Str</code> and hit <code>tab</code>, and a list with all the possible tokens will appear in the contextual window.</p>

<h3 id="automkdir">auto_mkdir</h3>

<p>Let’s say you’re writing a test for a non-existing class: <code>test/foo/bar/baz_test.rb</code>. The test is <em>”red”</em> and you want to define that class. Instead of return to the shell (<code>Ctrl+z</code>), create the directories (<code>mkdir -p lib/foo/bar</code>), then get back to Vim (<code>fg</code>) and create the file (<code>:e lib/foo/bar/baz.rb</code>). This is just annoying.</p>

<p>If you use <a href="https://github.com/DataWraith/auto_mkdir">auto_mkdir</a> and just edit the file (<code>:e lib/foo/bar/baz.rb</code>), it will auto-create all the intermediate missing directory. This is a huge time saving.</p>

<hr />

<p>If you don’t want to miss the next post about <strong>Tmux setup</strong>, please consider to subscribe to my mailing list.</p>

<hr />

<div id="mailing-list-lead">
  <p>If you want to stay updated with my latest articles, and software initiatives, please consider to subscribe my mailing list.</p>
  <p>No spam, I swear.</p>
</div>

<!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css" />

<div id="mc_embed_signup">
  <form action="//lucaguidi.us11.list-manage.com/subscribe/post?u=b48251cecfc2efe285b419263&amp;id=b92daedb57" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="novalidate">
    <label for="mce-EMAIL">Subscribe</label>
    <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required="required" />
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_b48251cecfc2efe285b419263_b92daedb57" value="" /></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button" /></div>
  </form>
</div>
<!--End mc_embed_signup-->
<p><br /></p>


            
<div class="social">
    <div>
        <a href="https://twitter.com/share" class="twitter-share-button"  data-text="Effective TDD With Ruby: Vim Setup" data-related="jodosha">Tweet</a>
    </div>
    
    
    <div>
        <div class="fb-like" data-width="150" data-layout="button_count" data-action="like" data-show-faces="true" data-send="false"></div>
    </div>
    
    
    <div>
        <div class="g-plusone" data-size="medium"></div>
    </div>
    
    
    
    <div>
        <a href="http://news.ycombinator.com/submit" class="hn-share-button">Vote on HN</a>
    </div>
    
</div>

        </section>

        <footer>
            <address>
               <img src="/images/lg.png">
                <p>Written by <strong><a rel="author" href="https://twitter.com/jodosha" title="" target="_blank">Luca Guidi</a></strong><br>
                <span class="muted">Developer, music connisseur and avid tea lover.</span>
                </p>
            </address>

        </footer>

        

        
    </div>
</article>


<footer class="site-footer">
  <div class="container">
    &copy; 2015 

    <nav>
      <a href="http://lucaguidi.com/">Luca Guidi</a> &middot;
      <a href="/">Blog</a> &middot;
      
      <a href="/about.html">About</a> &middot; 
      <a href="/archive.html" class="home">Archive</a> &middot;
      <a href="https://github.com/jodosha" class="code" target="_blank">Code</a> &middot;
      <a href="http://theplayli.st" class="code" target="_blank">Music</a>
    </nav>

    <nav class="social">
      
      <a href="https://twitter.com/jodosha" title="Follow on Twitter" target="_blank"><i class="icon icon-twitter black"></i></a>
      
      
      <a href="http://facebook.com/luca.guidi" title="Follow on Facebook" target="_blank"><i class="icon icon-facebook black"></i></a>
          
      <a href="http://feeds.feedburner.com/LucaGuidi" title="Atom Feed">
        <i class="icon icon-rss black"></i>
      </a>
    </nav>
    <p>Powered by <a href="http://jekyllrb.com">Jekyll</a> &middot; Incorporated theme by <a href="https://sendtoinc.com">Inc</a></p>
  </div>
</footer>

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="/assets/main.js"></script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=253595308025739";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<script>
    (function(d, t) {
        var g = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        g.src = '//hnbutton.appspot.com/static/hn.min.js';
        s.parentNode.insertBefore(g, s);
    }(document, 'script'));
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-235843-4', 'lucaguidi.com');
  ga('send', 'pageview');
</script>


</body>
</html>
